<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.spring.attendance.dao.AttendanceMapper">
	<!-- 근태 등록 -->
<insert id="insertAttendance" parameterType="kr.spring.attendance.vo.AttendanceVO">
	INSERT INTO attendance(
		attendance_id, 
		emp_id,
		work_date,
		scheduled_in_time,
		scheduled_out_time,
		status,
		work_type,
		check_in_time,
		check_out_time,
		notes,
		created_at,
		updated_at)
	VALUES (
		ATTENDANCE_SEQ.NEXTVAL,
		#{empId},
		#{workDate},
		TO_DATE('09:00', 'HH24:MI'),
        TO_DATE('18:00', 'HH24:MI'),
		#{status},
		#{workType},
		#{checkIntime,jdbcType=DATE},
		#{checkOuttime,jdbcType=DATE},
		#{notes},
		SYSDATE,
		SYSDATE)
	</insert>
	<!-- user_num 을 employeecode와 매핑-->
	<select id = "selectUserNumByEmployeeCode" parameterType="string" resultType="int">
		SELECT 
			user_num
		FROM euser
		WHERE employee_code = #{employeeCode}
	</select>
   
	<!-- 근태 목록 검색 -->
	<select id = "selectList" parameterType="map" resultType="kr.spring.attendance.vo.AttendanceVO">
	<!-- 날짜 직원번호 이름 상태 출근시간 퇴근시간 관리 -->
	SELECT
		a.work_date,
		a.emp_id,
		u.user_name,
		a.status,
		a.check_in_time,
		a.check_out_time,
		a.notes,
		a.created_at,
		a.updated_at
	FROM attendance a
	JOIN EUSER_DETAIL u ON a.emp_id = u.emp_id
	WHERE a.emp_id = #{empId} <!-- 사원번호 -->
	</select>
	
	
</mapper>
