<!DOCTYPE html>
<html xmlns:th="http://www.thyemleaf.org">
<head>
<meta charset="UTF-8">
<title>글 등록 완료</title>
<script type="text/javascript" th:inline="javascript">
	/*
	네추럴 템플릿(Natural Templates)
	백엔드 서버를 거치지 않아도 HTML과 JS가 "기본값"을 가지고있기 때문에 기본값을 노출시킴
	*/
	let message = /*[[${message}]]*/ '';
	let url = /*[[${url}]]*/ '';
	
	alert(message);
	
	if(url.includes('/logout')) {
		document.addEventListener('DOMContentLoaded', function() {
			const form = document.createElement('form');
			form.method = 'POST';
			form.action = url;
			
	        // 기존 meta 태그에서 CSRF 토큰 가져오기
	        const csrfToken = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content');
	        const csrfHeader = document.querySelector('meta[name="csrf-header"]')?.getAttribute('content');
	        
	        // CSRF 토큰 추가
	        if(csrfToken) {
	            const csrfInput = document.createElement('input');
	            csrfInput.type = 'hidden';
	            csrfInput.name = '_csrf';  // Spring Security 기본 parameter name
	            csrfInput.value = csrfToken;
	            form.appendChild(csrfInput);
	        }
	        
	        document.body.appendChild(form);
	        form.submit();
	    });
	} else {
		location.href = url;
	}
</script>
</head>
<body>
</body>
</html>